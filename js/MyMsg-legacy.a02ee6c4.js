(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["MyMsg"],{"172a":function(t,e,i){},"3c00":function(t,e,i){"use strict";var s=i("172a"),n=i.n(s);n.a},d1f7:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"my-msg-container"},[s("TheHeader",{attrs:{"left-arrow":"",title:t.$t("myMsg.myMsgInfo"),leftClick:t.goBack,isFixedTop:!0},on:{"click-right":t.toggleEdit},scopedSlots:t._u([{key:"right",fn:function(){return[s("img",{directives:[{name:"show",rawName:"v-show",value:!t.isEdit,expression:"!isEdit"}],staticClass:"edit-icon",attrs:{src:i("fe6a"),alt:""}}),s("BaseButton",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],staticClass:"header-action-btn"},[s("span",{staticClass:"header-btn-text"},[t._v(t._s(t.$t("myMsg.QuitEditing")))])])]},proxy:!0}])}),s("div",{staticClass:"search-filed"},[s("BaseCell",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v(t._s(t.$t("myMsg.Status")))]},proxy:!0},{key:"middle",fn:function(){return[s("div",{staticClass:"status-select"},[s("BaseSelector",{attrs:{columns:t.statusTypes,valueKey:"value",presentKey:"name",value:t.activeStatus},on:{confirm:t.onConfirm}})],1)]},proxy:!0}])})],1),s("div",{staticClass:"message-list-box"},[s("van-pull-refresh",{on:{refresh:t.init},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},t._l(t.messageList,(function(e,i){return s("van-swipe-cell",{key:e.id,attrs:{"right-width":65}},[s("van-cell-group",[s("div",{staticClass:"msg-box-wrapper"},[s("MsgBox",{attrs:{isEdit:t.isEdit,index:i,message:e},on:{click:function(i){return t.goMsgInfo(e)},check:t.onCheck}})],1)]),s("div",{staticClass:"swipe-delete-wrapper",attrs:{slot:"right"},slot:"right"},[s("div",{staticClass:"delete-button",on:{click:function(i){return t.delMsg([e.id])}}},[s("van-icon",{staticClass:"icon",attrs:{name:"cross"}})],1)])],1)})),1)],1),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],staticClass:"tool-bar"},[s("LinearButton",{staticClass:"tool-btn",on:{click:t.checkAll}},[t._v(t._s(t.$t("myMsg.SelectAll")))]),s("LinearButton",{staticClass:"tool-btn",on:{click:t.deleteAll}},[t._v(t._s(t.$t("myMsg.Delete")))]),s("LinearButton",{staticClass:"tool-btn",on:{click:t.allAsReaded}},[t._v(t._s(t.$t("myMsg.AllAsRead")))])],1),s("Pagination",{key:t.paginationKey,attrs:{isShow:t.isPaginationShow,isLoading:t.isPaginationLoading},on:{click:t.pagingFn}})],1)},n=[],a=i("9ccf");function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach((function(e){r(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var u={name:"MyMsg",data:function(){var t=this;return{statusTypes:[{name:function(){return"".concat(t.$t("myMsg.MyMessage"))},value:null},{name:function(){return"".concat(t.$t("myMsg.UnreadMessages"))},value:0},{name:function(){return"".concat(t.$t("myMsg.ReadMessages"))},value:1}],activeStatus:null,isEdit:!1,isLoading:!1,messageList:[],isPaginationShow:!1,isPaginationLoading:!1,paginationKey:1}},watch:{isEdit:function(){this.isEdit||this.messageList.forEach((function(t){t.isChecked=!1}))}},created:function(){this.init()},methods:{goBack:function(){var t=this;this.isEdit?this.$cf.showConfirmCancelDialog({title:"".concat(this.$t("myMsg.QuitEditing")),onConfirm:function(){Object(a["goBack"])(t.$route)}}):Object(a["goBack"])(this.$route)},onConfirm:function(t){this.activeStatus=t.value,this.init()},init:function(){var t=this;this.paginationKey=1,this.$api.my.myMsgList({body:{isRead:this.activeStatus,memberId:localStorage.getItem("memberId")},pageBean:{page:this.paginationKey,pageSize:15}},(function(e){t.isLoading=!1,t.messageList=e.data.data.map((function(e){return c(c({},e),{},{isChecked:!1,content:t.formHtml(e.content)})})),e.data.hasNextPage&&(t.isPaginationShow=!0)})),this.$api.my.getPerInfo({body:{}},(function(e){t.userName=e.data.username}))},formHtml:function(t){if(t){var e=new RegExp("(i?)(<img)([^>]+>)","gmi"),i=new RegExp("(i?)(<table)([^>]+>)","gmi");return t=t.replace(e,"<span>[图片]</span>"),t=t.replace(i,"<span>[表格]</span>"),t}return""},delMsg:function(t){var e=this;this.$cf.showConfirmCancelDialog({title:this.$t("myMsg.DeleteMessage"),message:this.$t("myMsg.DeleteTheMessage"),onConfirm:function(){e.$api.my.delMsg({body:{ids:t,memberId:localStorage.getItem("memberId"),username:e.userName}},(function(){e.init(),e.$cf.toast(e.$t("myMsg.MessageDeleted")),e.isEdit=!1}))}})},goMsgInfo:function(t){var e=this,i=t.id,s=t.messageId,n=t.msgType,a=t.isRead;a?this.$router.push({path:"/myMsgInfo",query:{id:i,messageId:s,msgType:n}}):this.$api.my.UpMsgItem({body:{id:i}},(function(){e.$router.push({path:"/myMsgInfo",query:{id:i,messageId:s,msgType:n}})}))},toggleEdit:function(){this.isEdit=!this.isEdit},onCheck:function(t){var e=this.messageList[t];e.isChecked=!e.isChecked},checkAll:function(){this.messageList.forEach((function(t){t.isChecked=!0}))},deleteAll:function(){var t=this.messageList.filter((function(t){return!0===t.isChecked})).map((function(t){return t.id}));this.delMsg(t)},allAsReaded:function(){var t=this,e=this.messageList.map((function(t){return t.id}));this.$api.my.changeMultiMessageStatus({body:{ids:e}},(function(){t.messageList.forEach((function(t){t.isRead=1}))}))},getMsgList:function(){var t=this;this.isPaginationLoading=!0,this.paginationKey++,this.$api.my.myMsgList({body:{isRead:this.activeStatus,memberId:localStorage.getItem("memberId")},pageBean:{page:this.paginationKey,pageSize:15}},(function(e){t.isPaginationLoading=!1,e.data.hasNextPage||(t.isPaginationShow=!1);var i=e.data.data.map((function(e){return c(c({},e),{},{isChecked:!1,content:t.formHtml(e.content)})}));t.messageList=t.messageList.concat(i)}))},pagingFn:function(){this.getMsgList()}},components:{MsgBox:function(){return i.e("chunk-1248d5ec").then(i.bind(null,"f5f8"))},LinearButton:function(){return i.e("chunk-73bcffce").then(i.bind(null,"ec6b"))},Pagination:function(){return i.e("chunk-2d0c08b4").then(i.bind(null,"41de"))}}},l=u,g=(i("3c00"),i("2877")),d=Object(g["a"])(l,s,n,!1,null,"01649716",null);e["default"]=d.exports},fe6a:function(t,e,i){t.exports=i.p+"img/icon-edit.2b827995.svg"}}]);