(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["register"],{"51c4":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"register-container"},[e.isLoading?s("div",{staticClass:"loading-mask"},[s("van-loading",{attrs:{size:"24px"}})],1):e._e(),s("TheHeader",{staticClass:"transparent",attrs:{"left-arrow":"",leftClick:e.goHome}}),s("div",{staticClass:"sign-up-img-box"},[s("img",{attrs:{src:i("c011"),alt:""}})]),s("div",{staticClass:"sign-up-form-box"},[s("div",{staticClass:"box-summery"},[s("h2",[e._v(e._s(e.$t("register.Register")))])]),s("div",{staticClass:"progress-container"},[s("div",{staticClass:"progress",style:{width:e.progressWidth+"%"}}),s("div",{staticClass:"circle",class:{active:1===e.step||2===e.step}},[e._v("1")]),s("div",{staticClass:"circle",class:{active:2===e.step}},[e._v("2")]),s("div",{staticClass:"circle"},[e._v("3")])]),1===e.step?s("p",{staticClass:"register-para"},[e._v(e._s(e.$t("register.RegisterWithLineID")))]):e._e(),1===e.step?s("LineButton",{on:{click:e.lineLogin}}):e._e(),s("van-form",{ref:"formRef",staticClass:"sign-up-form",attrs:{"validate-trigger":"onChange"},on:{submit:e.onSubmit}},[1===e.step?s("div",e._l(e.formFields,(function(t){return s("van-field",e._b({key:t.name,scopedSlots:e._u([{key:"input",fn:function(){return[s("CustomVanFieldInput",{attrs:{useInvisibility:t.useInvisibility,maxlength:t.maxlength,useStateIcon:!1,inputClass:t.inputClass,placeholder:t.placeholder,type:t.type},on:{"update:type":function(i){return e.$set(t,"type",i)},blur:function(e){t.blur&&t.blur(t)}},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"field.value"}})]},proxy:!0}],null,!0)},"van-field",t,!1))})),1):s("div",e._l(e.stepTwoFormField,(function(t){return s("van-field",e._b({key:t.name,scopedSlots:e._u([{key:"input",fn:function(){return[s("CustomVanFieldInput",{attrs:{useInvisibility:t.useInvisibility,maxlength:t.maxlength,useStateIcon:!1,inputClass:t.inputClass,placeholder:t.placeholder,type:t.type},on:{"update:type":function(i){return e.$set(t,"type",i)},blur:function(e){t.blur&&t.blur(t)}},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"field.value"}})]},proxy:!0}],null,!0)},"van-field",t,!1))})),1),s("div",{staticClass:"checkbox-block"},[2===e.step&&e.showAuthBonus?s("van-checkbox",{attrs:{shape:"square","checked-color":"#4ca3fe"},model:{value:e.isBindPhone,callback:function(t){e.isBindPhone=t},expression:"isBindPhone"}},[e._v(e._s(e.$t("register.VerifyAndGetBonus")))]):e._e()],1),e.isBindPhone?s("div",[s("van-field",e._b({key:e.additionFields[0].name,scopedSlots:e._u([{key:"input",fn:function(){return[s("BaseSelector",{attrs:{columns:e.nationCodes,valueKey:"value",presentKey:"label",value:e.nationCode},on:{confirm:e.onNCSelect}}),s("CustomVanFieldInput",{attrs:{useInvisibility:e.additionFields[0].useInvisibility,maxlength:e.additionFields[0].maxlength,useStateIcon:!1,inputClass:e.additionFields[0].inputClass,placeholder:e.additionFields[0].placeholder,type:e.additionFields[0].type},on:{"update:type":function(t){return e.$set(e.additionFields[0],"type",t)},blur:function(t){e.additionFields[0].blur&&e.additionFields[0].blur(e.field)}},model:{value:e.additionFields[0].value,callback:function(t){e.$set(e.additionFields[0],"value",t)},expression:"additionFields[0].value"}})]},proxy:!0}],null,!1,2899968775)},"van-field",e.additionFields[0],!1)),s("van-field",e._b({key:e.additionFields[1].name,staticClass:"get-validate-code-field",scopedSlots:e._u([{key:"input",fn:function(){return[s("div",{staticClass:"validation-code-wrapper"},[s("custom-van-field-input",{attrs:{validatedState:e.additionFields[1].state,maxlength:e.additionFields[1].maxlength,inputClass:e.additionFields[1].inputClass,placeholder:e.additionFields[1].placeholder,useStateIcon:e.additionFields[1].useStateIcon},on:{input:function(t){return e.onInputChange(e.additionFields[1])}},model:{value:e.additionFields[1].value,callback:function(t){e.$set(e.additionFields[1],"value","string"===typeof t?t.trim():t)},expression:"additionFields[1].value"}}),s("div",{staticClass:"state-icon-container"},[s("BaseButton",{staticClass:"receive-validate-btn",attrs:{type:"button",disabled:0!==e.timerCount},on:{click:e.sendPhoneCode}},[e._v(e._s(e.sendPhoneCodeBtnText))])],1)],1)]},proxy:!0}],null,!1,609999631)},"van-field",e.additionFields[1],!1))],1):e._e(),s("van-button",{staticClass:"submit-btn",attrs:{type:"submit"}},[e._v(e._s(1===e.step?e.$t("found1.Next"):e.$t("register.Register")))]),e.isLiveyabo?e._e():s("p",[e._v(" "+e._s(e.$t("register.Goto"))+" "),s("a",{staticClass:"sign-up-link",on:{click:function(t){return t.preventDefault(),e.$router.push({path:"/login"})}}},[e._v(e._s(e.$t("register.SignIn")))])])],1)],1),s("van-dialog",{staticClass:"slide-verify",attrs:{showConfirmButton:!1},model:{value:e.isShowVerifyImageDialog,callback:function(t){e.isShowVerifyImageDialog=t},expression:"isShowVerifyImageDialog"}},[s("SlideVerifyWithClose",{ref:"slideContainer",attrs:{imgs:e.validationimgs},on:{success:e.onImgValidateSuccess,close:e.onSlideVerifyClose}})],1)],1)},n=[],a=i("f2dc"),o=i("655c"),l=i("2f62"),r=i("f9a9"),d=i("8cae");function u(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function c(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?u(Object(i),!0).forEach((function(t){g(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):u(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function g(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var h={name:"Register",mixins:[d["a"]],data(){return{isBindPhone:!1,validationImgId:"",validationimgs:[],isShowVerifyImageDialog:!1,isValidated:!1,notAllowPhoneNumber:"",timerCount:0,sendPhoneCodeBtnText:this.$t("register.GetValidateCode"),phoneValidateMsg:this.$t("register.PhoneValidationWarning"),active:!0,step:1,isLoading:!1,formFields:[{name:"username",value:"",maxlength:10,label:" ",labelClass:"no-text field-icon-account",prefix:!0,inputClass:"username-input",blur(e){e.value=e.value.toUpperCase()},placeholder:this.$t("register.AccountPlaceholder"),rules:[{required:!0,message:this.$t("register.AccountValidationWarning")},{message:this.$t("register.AccountValidationWarning2"),validator:e=>{if(e)return a["a"].THAcount(e).flag}}]},{name:"password",value:"",label:" ",labelClass:"no-text field-icon-password",maxlength:16,type:"password",useInvisibility:!0,placeholder:this.$t("register.PwdPlaceholder"),rules:[{required:!0,message:this.$t("register.PwdValidationWarning")},{message:this.$t("register.PwdValidationWarning2"),validator:e=>{if(e)return a["a"].THPasswordValid(e).flag}}]},{name:"password-confirm",value:"",label:" ",labelClass:"no-text field-icon-password",maxlength:16,type:"password",useInvisibility:!0,placeholder:this.$t("register.ConfirmPlaceholder"),rules:[{required:!0,message:this.$t("register.ConfirmValidationWarning")},{message:this.$t("register.ConfirmValidationWarning2"),validator:e=>{const t=this.formFields.find(e=>"password"===e.name);return e===t.value}}]}],stepTwoFormField:[{name:"realname",value:"",label:" ",labelClass:"no-text field-icon-realname",maxlength:128,placeholder:this.$t("register.UserNamePlaceholder"),rules:[{required:!0,message:this.$t("register.UserNameValidationWarning")},{message:this.$t("register.UserNameValidationWarning3"),validator:e=>{if(e)return a["a"].THRealName(e).flag}}]}],additionFields:[{name:"mobile",value:"",label:"",labelClass:"label-mobile",maxlength:10,placeholder:this.$t("register.PhonePlaceholder"),rules:[{required:!0,message:this.$t("register.PhoneValidationWarning1")},{message:this.$t("register.PhoneValidationWarning2"),validator:e=>{if(e){const t=a["a"].phoneNum(e,this.notAllowPhoneNumber,o["a"].th,this.nationCode);return t.flag}}}]},{name:"mobileAuthCode",value:"",maxlength:10,placeholder:this.$t("register.ValidationCodeBtnPlaceholder"),rules:[{required:!0,message:this.$t("register.ValidationCodeValidateWarning")},{message:this.$t("register.ValidationCodeValidateWarning2"),validator:e=>e.length<=10}]}],showAuthBonus:!1}},computed:{phoneNumber(){return this.getPhoneNumWithNationCode({nationCode:this.nationCode,phone:this.additionFields[0].value})},isLiveyabo(){const e=window.location.href;return e.includes("yabo")},computedformFields:{get(){return this.isBindPhone?this.formFields.concat(this.additionFields).concat(this.stepTwoFormField):this.formFields.concat(this.stepTwoFormField)},set(e){this.isBindPhone&&(this.formFields=e.slice(0,4),this.additionFields=e.slice(4,6)),this.formFields=e}},progressWidth(){let e=0;switch(this.step){case 1:e=0;break;case 2:e=50;break;case 3:e=100;break;default:break}return e}},created(){this.getImageCode(),this.$api.register.phoneFormatVerify({},e=>{this.notAllowPhoneNumber=e.data.regTelNotAllow.split(",").join("|"),this.showAuthBonus=e.data.wasShowVerifyToGetBonus}),localStorage.getItem("lineIdToken")&&(this.step=2),window.gtag("event","注册")},methods:c(c({},Object(l["b"])(["doLogin"])),{},{onNCSelect(e){this.nationCode=e.value,this.formFields[0].value&&this.$refs.formRef.validate("mobile")},goHome(){this.$router.push("/")},onSlideVerifyClose(){this.isShowVerifyImageDialog=!1,this.$refs.slideContainer.$refs.slideblock.reset()},nextStep(){this.step+=1},lineLogin(){Object(r["a"])()},lineRegister(){const e=[...this.computedformFields].reduce((e,t)=>(e[t.name]=t.value,e),{});e.mobile&&(e.mobile=e.mobile.length>9?e.mobile.slice(1):e.mobile);const t=`${this.additionFields[0].label.split("+")[1]}-${e.mobile}`,i={idToken:localStorage.getItem("lineIdToken"),realName:this.stepTwoFormField[0].value,mobile:e.mobile?t:"",mobileAuthCode:e.mobileAuthCode,recomCode:sessionStorage.getItem("recomCode")};this.isLoading=!0,this.$api.my.lineRegister({body:i},e=>{sessionStorage.removeItem("recomCode");const{data:t}=e;this.doLogin(t),this.isLoading=!1,this.getUnAuthItems(),this.$cf.showSuccessMessageDialog({title:this.$t("register.RegisterSuccessTitle"),message:`\n                <p>${this.$t("register.RegisterSuccessToast",[i.realName])}</p>\n                <p>${this.$t("register.RegisterSuccessMessage")}</p>\n                `}),setTimeout(()=>{this.$router.push({path:"/"})},2e3)})},onSubmit(){1!==this.step?2===this.step&&localStorage.getItem("lineIdToken")?this.lineRegister():(this.isValidated=!0,this.validationImgId?this.isShowVerifyImageDialog=!0:this.register()):this.nextStep()},onFailed({errors:e}){this.isValidated=!0;const t=e.map(e=>e.name);this.computedformFields.forEach(e=>{t.includes(e.name)?e.state=!1:e.state=!0})},onImgValidateSuccess(){this.isShowVerifyImageDialog=!1;const e=this.$refs.slideContainer.$refs.slideblock;e.reset(),this.register()},getImageCode(){this.$api.login.getImgCode({body:{}},({data:e})=>{null!==(null===e||void 0===e?void 0:e.code)&&(this.validationImgId=e.id,this.validationimgs=this.$cf.getSlideImg())})},toggleType(e){e.type="password"===e.type?"text":"password"},timerCounting(){0!==this.timerCount?(this.sendPhoneCodeBtnText=this.$t("register.ResendCountDown",[this.timerCount]),this.timerCount--,setTimeout(()=>{this.timerCounting()},1e3)):this.sendPhoneCodeBtnText=this.$t("register.GetValidateCode")},sendPhoneCode(){this.additionFields[0].value?this.$api.register.getAuthCode({body:{recipient:this.phoneNumber}},()=>{this.timerCount=60,this.timerCounting(),this.$cf.showSuccessMessageDialog(this.$t("register.PopMsg2"))}):this.$cf.toast(this.$t("register.PhoneValidationWarning1"))},getUnAuthItems(){this.$store.dispatch("getPendingAuth",{vm:this})},register(){const e=[...this.computedformFields].reduce((e,t)=>(e[t.name]=t.value,e),{});e.mobile&&(e.mobile=e.mobile.length>9?e.mobile.slice(1):e.mobile);const t={password:e.password,realname:e.realname,username:e.username,mobile:e.mobile?this.phoneNumber:"",mobileAuthCode:e.mobileAuthCode,recomCode:sessionStorage.getItem("recomCode")};this.$api.register.register({body:t},()=>{const{username:e,password:i}=this.formFields.reduce((e,t)=>(e[t.name]=t,e),{});this.$api.login.signin({body:{username:e.value,userpass:i.value}},e=>{window.gtag("event","登入"),sessionStorage.removeItem("recomCode"),this.doLogin(e.data),this.getUnAuthItems(),this.$cf.showSuccessMessageDialog({title:this.$t("register.RegisterSuccessTitle"),message:`\n                <p>${this.$t("register.RegisterSuccessToast",[t.realname.length>10?t.realname.slice(0,10)+"...":t.realname])}</p>\n                <p>${this.$t("register.RegisterSuccessMessage")}</p>\n                `}),setTimeout(()=>{this.$router.push({path:"/"})},2e3)})})}}),components:{CustomVanFieldInput:()=>i.e("chunk-50b477c4").then(i.bind(null,"5623")),SlideVerifyWithClose:()=>i.e("chunk-3c54145e").then(i.bind(null,"cb51")),LineButton:()=>i.e("chunk-d0b69c88").then(i.bind(null,"d1f3"))}},m=h,p=(i("7048"),i("2877")),f=Object(p["a"])(m,s,n,!1,null,null,null);t["default"]=f.exports},"655c":function(e,t,i){"use strict";t["a"]={cn:{phoneNumberLengh:11,ruleName:"phoneNumRuleCN",blackRuleName:"phoneBlackListCN"},th:{phoneNumberLengh:10,ruleName:"phoneNumRuleTH",blackRuleName:"phoneBlackListTH"}}},7048:function(e,t,i){"use strict";var s=i("dbfe"),n=i.n(s);n.a},"8cae":function(e,t,i){"use strict";const{getPhoneNumWithNationCode:s,getNationCodes:n}=i("9ccf");let a;a={},t["a"]={data(){return{nationCode:"66",nationCodes:n()}},methods:{getPhoneNumWithNationCode(e){return s(e)}},components:a}},c011:function(e,t,i){e.exports=i.p+"img/logo.f3296670.svg"},dbfe:function(e,t,i){},f2dc:function(e,t,i){"use strict";var s=i("72f2");t["a"]={strnumDa6(e){const t=/^[a-zA-Z0-9]{6,}$/,i=new RegExp(t);return{flag:i.test(e),text:"请输入6位以上数字或字母"}},passwordValid(e){const t=/^[a-zA-Z0-9_]{6,}$/,i=new RegExp(t);return{flag:i.test(e),text:"格式須由 6~16 位半形英数字及下底線组成"}},BDYPasswordValid(e){const t=/^[a-zA-Z0-9]{6,16}$/,i=new RegExp(t);return{flag:i.test(e),text:"格式須由 6~16 位半形英数字"}},BFDrawNumber(e){const t=/^[0-9]{4,8}$/,i=new RegExp(t);return{flag:i.test(e),text:"格式错误，请设定 4~8 位数字密码"}},BDYDrawNumber(e){const t=/^[0-9]{6,}$/,i=new RegExp(t);return{flag:i.test(e),text:"格式错误，请设定 6 位数字密码"}},BFAccount(e){const t=/^BF[a-zA-Z0-9]{4,}$/,i=new RegExp(t);return{flag:i.test(e),text:"帐号格式必须为BF开头且符合 6~14 位"}},EDFAccount(e){const t=/^EDF[a-zA-Z0-9]{4,}$/,i=new RegExp(t);return{flag:i.test(e),text:"帐号格式必须为EDF开头且符合 6~14 位"}},BDYAcount(e){const t=/^[a-zA-Z0-9]{4,12}$/,i=new RegExp(t);return{flag:i.test(e),text:"帐号长度必须为 4~12 位半形英数字"}},THAcount(e){const t=/^(?=.*[a-zA-Z])(?=.*\d)[a-zA-Z0-9]{6,10}$/,i=new RegExp(t);return{flag:i.test(e),text:"账号格式为6-10位英文+数字的組合"}},THAcountLogin(e){const t=/^[a-zA-Z0-9]{6,10}$/,i=new RegExp(t);return{flag:i.test(e),text:"账号格式为6-10位英文+数字的組合"}},LOAccountLogin(e){const t=/^LE[a-zA-Z0-9]{6,10}$/,i=new RegExp(t);return{flag:i.test(e),text:"帐号格式必须为LE开头且符合 8~12 位"}},THPasswordValid(e){const t=/^[a-zA-Z0-9_]{6,16}$/,i=new RegExp(t);return{flag:i.test(e),text:"密码格式为6-16位英数字及 '_'"}},THRealName(e){const t=/^[a-zA-Z\u4E00-\u9FA5\u0E01-\u0E5B ]{2,128}$/,i=new RegExp(t);return{flag:i.test(e),text:"请输入汉字"}},phoneNum(e,t,i,s){let n;if(e){n=i?this[i.ruleName](e,t,s):this.phoneNumRuleCN(e,t,s);const a=i?this[i.blackRuleName](e,t,s):this.phoneBlackListCN(e,t,s);return a.flag||(n=a),n}},phoneNumRuleTH(e){const t=/^\d{9,10}$/,i=new RegExp(t);return{flag:i.test(e),text:"手机号码格式错误"}},phoneNumRuleCN(e){const t=/^1\d{10}$/,i=new RegExp(t);return{flag:i.test(e)&&11===e.length&&e.startsWith("1"),text:"手机号码格式错误"}},phoneBlackListCN(e,t,i){t=t||s["a"].state.notAllowPhoneNumber,i=i||s["a"].state.nationCode;let n=i;i||(n=""===i?"86":"66");const a=[];let o=!0;t.split("|").forEach(e=>{const t=e.split("-");t.length<2&&(o=!1),t[0]===n&&a.push(t[1])});const l=o?a.join("|"):t,r=`^(${l}){1,}[0-9]{8,9}$`,d=new RegExp(r);return{flag:!d.test(e)&&11===e.length&&e.startsWith("1"),text:"手机号码无法使用，请联系客服"}},phoneBlackListTH(e,t,i){t=t||s["a"].state.notAllowPhoneNumber,i=i||s["a"].state.nationCode;let n=i;i||(n=""===i?"86":"66");const a=[];let o=!0;t.split("|").forEach(e=>{const t=e.split("-");t.length<2&&(o=!1),t[0]===n&&a.push(t[1])});const l=o?a.join("|"):t,r=`^(${l}){1,}[0-9]{6,8}$`,d=new RegExp(r);return{flag:!d.test(e),text:"手机号码无法使用，请联系客服"}},email(e){const t=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,i=new RegExp(t);return{flag:i.test(e),text:"请输入正确的邮箱号码格式"}},yuming(e){const t=/[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\/.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+\/.?/,i=new RegExp(t);return{flag:i.test(e),text:"请输入正确的域名格式"}},shenfenz(e){const t=/(^d{15}$)|(^d{17}([0-9]|X)$)/,i=new RegExp(t);return{flag:i.test(e),text:"请输入正确的身份证号码格式"}},number(e){const t=/^[0-9]*$/,i=new RegExp(t);return{flag:i.test(e),text:"请输入数字"}},hanzi(e){const t=/^[\u4e00-\u9fa5·．]{0,}$/,i=new RegExp(t);return{flag:i.test(e),text:"请输入汉字"}},BDYRealName(e){const t=/^[\u4e00-\u9fa5·．]{2,}$/,i=new RegExp(t);return{flag:i.test(e),text:"请输入汉字"}},strnum(e){const t=/^[A-Za-z0-9]+$ 或 ^[A-Za-z0-9]{4,40}$/,i=new RegExp(t);return{flag:i.test(e),text:"请输入数字或字母"}},noFullWidth(e){const t=/[\uff00-\uffff]/g,i=new RegExp(t);return{flag:!i.test(e),text:"格式错误，不可包含全形"}},validYoung(e){const t=new Date,i=new Date(e);let s=t.getFullYear()-i.getFullYear();const n=t.getMonth()-i.getMonth();return(n<0||0===n&&t.getDate()<i.getDate())&&(s-=1),{flag:s>=18,text:"未满18岁，无法注册"}},specialCharacters(e){const t=/^[A-Za-z0-9\u4e00-\u9fa5]{1,20}$/,i=new RegExp(t);return{flag:i.test(e),text:"格式错误，限中、英、数字"}}}},f9a9:function(e,t,i){"use strict";const s=()=>{const e=""+window.location.origin;let t="https://access.line.me/oauth2/v2.1/authorize?";t+="response_type=code",t+="&client_id=1656312487",t+="&redirect_uri="+e,t+="&state=123456789",t+="&scope=profile%20openid%20email",t+="&bot_prompt=aggressive",window.open(t,"_self")};t["a"]=s}}]);