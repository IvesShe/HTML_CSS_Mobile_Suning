(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["opinion"],{2114:function(i,t,a){"use strict";a.r(t);var n=function(){var i=this,t=i.$createElement,a=i._self._c||t;return a("div",{staticClass:"view-opinion-container"},[a("TheHeader",{attrs:{title:i.$t("myInfo.Feedback"),"left-arrow":"","left-click":i.goBack,isFixedTop:!0}}),a("van-notice-bar",{attrs:{wrapable:"",scrollable:!1,mode:"closeable"}},[i._v(i._s(i.$t("opinion.TitleTips")))]),a("div",[a("div",{staticClass:"field-box"},[a("van-field",{attrs:{maxlength:"200",type:"textarea",rows:"6",placeholder:i.$t("opinion.EnterFeedback")},on:{input:i.inputChange},model:{value:i.value,callback:function(t){i.value=t},expression:"value"}}),a("div",{staticClass:"field-boxtext"},[i._v(i._s(i.maxText.theNum)+" / "+i._s(i.maxText.maxNum))])],1),a("div",{staticClass:"btn_box"},[a("div",{staticClass:"avatar-uploader"},[i.imagePath?i._e():a("van-uploader",{attrs:{"after-read":i.onRead,"before-read":i.onBefore,"max-size":"3145728"},on:{oversize:i.oversize}},[i.imagePath?i._e():a("LinearButton",{staticClass:"opinion_btn",attrs:{type:"info"}},[i._v(i._s(i.$t("opinion.UploadImage")))])],1),i.imagePath?a("div",{staticClass:"preview-image"},[a("span",{staticClass:"delete-icon",on:{click:i.showConfirmModal}}),i.imagePath?a("img",{attrs:{src:i.imagePath,alt:""}}):i._e()]):i._e(),a("span",{staticClass:"image-limit-info"},[a("van-icon",{attrs:{name:"warning-o"}}),i._v(" "+i._s(i.$t("opinion.ImageLimitTips"))+" ")],1)],1),a("LinearButton",{attrs:{block:"",size:"",type:"info"},on:{click:i.UpOpinion}},[i._v(i._s(i.$t("opinion.SubmitFeedback")))])],1)]),i._l(i.opiList,(function(t){return a("van-panel",{key:t.id,staticClass:"my-panel",attrs:{title:t.username,status:i.getStateText(t.status)}},[a("div",{staticClass:"pan-con"},[a("div",[i._v(i._s(t.content))]),a("p",{staticClass:"pan-div"},[t.image?a("a",{staticClass:"img-link",attrs:{href:t.image,target:"_blank"}},[i._v(i._s(i.$t("opinion.Drawing")))]):i._e(),a("span",{staticClass:"pan-time"},[i._v(i._s(t.addTime))])]),a("div",{directives:[{name:"show",rawName:"v-show",value:1==t.status,expression:"e.status==1"}],staticClass:"pan-huifu"},[a("div",[i._v(i._s(i.$t("opinion.Reply"))+"ï¼š"+i._s(t.remark))]),a("p",{staticClass:"pan-time"},[i._v(i._s(t.feedbackTime))])])])])})),a("Pagination",{key:i.paginationKey,attrs:{isShow:i.isPaginationShow,isLoading:i.isPaginationLoading},on:{click:i.pagingFn}})],2)},e=[],o=a("9ccf"),s={data:function(){return{opiList:[],value:"",username:"",maxText:{theNum:0,maxNum:200},imagePath:"",isPaginationShow:!1,isPaginationLoading:!1,paginationKey:0}},computed:{pageTitle:function(){return this.$global_config.IS_BDY?this.$t("opinion.Feedback1"):this.$t("opinion.Feedback2")}},created:function(){this.userInfo()},methods:{goBack:function(){Object(o["goBack"])(this.$route)},getStateText:function(i){return 0===i?this.$t("opinion.NoReply"):""},getOpinionList:function(i,t){var a=this;this.isPaginationLoading=!0,this.$api.my.getOpinionList({body:{username:this.username},pageBean:{page:i||1,pageSize:15}},(function(i){var n,e,o;null!==t&&void 0!==t&&t.isStack?a.opiList=a.opiList.concat((null===(e=i.data)||void 0===e?void 0:e.data)||[]):a.opiList=(null===(o=i.data)||void 0===o?void 0:o.data)||[];null!==t&&void 0!==t&&t.initPage&&a.paginationKey++,a.isPaginationShow=null===(n=i.data)||void 0===n?void 0:n.hasNextPage,a.isPaginationLoading=!1,a.setReadAll()}),(function(){a.isPaginationLoading=!1}))},setReadAll:function(){this.$api.my.readAll({body:{}},(function(){}))},UpOpinion:function(){var i=this;""!==this.value?this.$api.my.UpOpinion({body:{content:this.value,image:this.imagePath}},(function(t){i.getOpinionList(void 0,{isStack:!1,initPage:!0}),i.value="",i.imagePath="",i.maxText.theNum=0,i.$cf.showSuccessMessageDialog(t.message)})):this.$cf.showErrorMessageDialog(this.$t("opinion.EnterContentFeedback"))},inputChange:function(i){i.length<=this.maxText.maxNum&&(this.maxText.theNum=i.length)},userInfo:function(){var i=this;this.$api.my.getPerInfo({body:{}},(function(t){i.username=t.data.username,i.getOpinionList()}))},pagingFn:function(i){var t=i.currentPage;this.getOpinionList(t,{isStack:!0,initPage:!1})},onRead:function(i){var t=this,a=new FormData;a.append("file",i.file),this.$api.my.uploadImg(a).then((function(i){t.imagePath=i.data.data}),(function(){t.$cf.showErrorMessageDialog(t.$t("opinion.FailedToUploadImages"))}))},oversize:function(){this.$cf.showErrorMessageDialog(this.$t("opinion.FailedUploadWarning1"))},onBefore:function(i,t){return-1===i.type.indexOf("jpg")&&-1===i.type.indexOf("jpeg")&&-1===i.type.indexOf("png")&&-1===i.type.indexOf("gif")?(this.$cf.showErrorMessageDialog(this.$t("opinion.FailedUploadWarning2")),!1):t},showConfirmModal:function(){var i=this;this.$cf.showConfirmCancelDialog({title:this.$t("opinion.ConfirmDelete"),onConfirm:function(){i.imagePath=""}})}},components:{Pagination:function(i){a.e("chunk-2d0c08b4").then(function(){var t=[a("41de")];i.apply(null,t)}.bind(this)).catch(a.oe)},LinearButton:function(){return a.e("chunk-73bcffce").then(a.bind(null,"ec6b"))}}},c=s,l=(a("6996"),a("2877")),r=Object(l["a"])(c,n,e,!1,null,"0315c090",null);t["default"]=r.exports},6996:function(i,t,a){"use strict";var n=a("bd02"),e=a.n(n);e.a},bd02:function(i,t,a){}}]);