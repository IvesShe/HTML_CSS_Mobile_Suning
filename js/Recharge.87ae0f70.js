(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Recharge"],{"091a":function(e,t,n){e.exports=n.p+"img/qrcode-1.0e7124f3.png"},"2cb3":function(e,t,n){"use strict";var a=n("329b"),i=n.n(a);i.a},"2cca":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"recharge-tutorial-container"},[a("TheHeader",{attrs:{"left-arrow":"",title:e.$t("recharge.RechargeTutoral"),"left-click":e.goBack}}),a("div",{staticClass:"row-section"},[a("BaseSelector",{staticClass:"tutorial-selector",attrs:{columns:e.tutorials,value:e.activeTutorial.value,valueKey:"value",presentKey:"label"},on:{confirm:e.onSelectTutorial}}),a("div",{staticClass:"progress-text"},[a("h3",[e._v(e._s(e.$t("recharge.Step")))]),a("h3",[a("span",{staticClass:"progress-text__highlight"},[e._v(e._s(e.activeIndex))]),e._v(" /"+e._s(e.steps)+" ")])]),a("div",{staticClass:"progress-bar"},[a("div",{staticClass:"progress-bar-active",style:"width: "+e.activeIndex/e.steps*100+"%"})])],1),a("div",{staticClass:"img-container"},[e._l(e.steps,(function(t){return a("img",{key:t+"-"+e.activeTutorial.value,ref:e.activeTutorial.value,refInFor:!0,attrs:{src:e.getImage(t)}})})),a("img",{staticClass:"img-container__icon",attrs:{src:n("9a64"),alt:""},on:{click:e.scrollToTop}})],2)],1)},i=[],o={name:"Tutorial",data(){return{activeTutorial:{label:()=>this.$t("recharge.QRcode"),value:"qrcode"},tutorials:[{label:()=>this.$t("recharge.QRcode"),value:"qrcode"},{label:()=>this.$t("recharge.TransferTutorial"),value:"transfer"}],steps:6,activeIndex:1,observer:null}},mounted(){this.setObserver("qrcode")},methods:{async setObserver(e){const t=this.$refs[e];this.observer=await new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const n=t.findIndex(t=>t.src===e.target.src);this.activeIndex=n+1}})},{threshold:.6}),t.forEach(e=>this.observer.observe(e)),this.$once("hook:beforeDestroy",()=>{t.forEach(e=>this.observer.unobserve(e))})},getImage(e){try{return n("ba6a")(`./${this.activeTutorial.value}-${e}.png`)}catch(t){return""}},goBack(){this.$router.go(-1)},onSelectTutorial(e){this.steps="qrcode"===e.value?6:5,this.activeTutorial=e,this.$nextTick(async()=>{await this.setObserver(this.activeTutorial.value),setTimeout(()=>{this.activeIndex=1},0)})},scrollToTop(){const e=this.$refs[this.activeTutorial.value];e&&e[0].scrollIntoView({behavior:"smooth"})}}},r=o,s=(n("3c9d"),n("2877")),c=Object(s["a"])(r,a,i,!1,null,null,null);t["default"]=c.exports},"329b":function(e,t,n){},3625:function(e,t,n){e.exports=n.p+"img/transfer-3.a6a8509a.png"},"3c9d":function(e,t,n){"use strict";var a=n("b54e"),i=n.n(a);i.a},"42da":function(e,t,n){e.exports=n.p+"img/qrcode-6.74138ef1.png"},4518:function(e,t,n){e.exports=n.p+"img/transfer-4.73debe71.png"},"5a2c":function(e,t,n){e.exports=n.p+"img/transfer-1.c2822a75.png"},"69fd":function(e,t,n){e.exports=n.p+"img/qrcode-3.88e3c50b.png"},"75e0":function(e,t,n){e.exports=n.p+"img/transfer-5.e06c6c08.png"},"7e00":function(e,t,n){e.exports=n.p+"img/qrcode-5.568b3e36.png"},"9a64":function(e,t,n){e.exports=n.p+"img/icon-totop.f9bec70f.svg"},a148:function(e,t,n){e.exports=n.p+"img/transfer-2.fd25a022.png"},a424:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"recharge-container"},[n("TheHeader",{attrs:{"left-arrow":"",title:e.$t("recharge.Recharge"),"left-click":e.goBack,isFixedTop:!0}}),n("div",{staticClass:"tutorial",on:{click:function(t){return e.$router.push({path:"/tutorial"})}}},[n("span",[e._v(e._s(e.$t("recharge.Tutorial")))]),n("i",{staticClass:"tutorial__icon"})]),n("div",{staticClass:"row-section"},[n("p",[e._v("1. "+e._s(e.$t("recharge.DepositWay")))]),n("div",{staticClass:"payment-method-wrapper"},e._l(e.paymentMethods,(function(t){return n("BaseButton",{key:t.type,staticClass:"payment-method-btn",class:{active:e.activeMethod.type===t.type},on:{click:function(n){return e.changeMethod(t)}}},[n("div",{class:"icon icon-"+t.type}),e._v(" "+e._s(t.typeName)+" ")])})),1)]),n("div",{staticClass:"row-section"},[n("p",[e._v("2. "+e._s(e.$t("recharge.DepositLine")))]),n("div",{staticClass:"payment-channel-wrapper"},e._l(e.activeMethod.list,(function(t){return n("BaseButton",{key:t.id,staticClass:"payment-channel-btn",class:{active:e.activeChannel.id===t.id},on:{click:function(n){return e.changeChannel(t)}}},[e._v(e._s(t.name))])})),1)]),n("div",{staticClass:"row-section"},[n("p",[e._v("3. "+e._s(e.$t("recharge.Concessionary")))]),n("div",{staticClass:"payment-discount-wrapper",on:{click:function(t){e.showPromotion=!0}}},[n("span",{staticClass:"text"},[e._v(e._s(e.activePromotion.name))]),n("div",[n("van-icon",{staticClass:"arrow-icon",attrs:{name:"arrow-down"}})],1)])]),n("van-action-sheet",{attrs:{actions:e.promotions,"cancel-text":"取消"},on:{open:function(t){return e.getPromotionList()},select:e.onSelectPromotion,cancel:function(t){e.showPromotion=!1}},model:{value:e.showPromotion,callback:function(t){e.showPromotion=t},expression:"showPromotion"}}),n("van-form",{ref:"formRef",attrs:{"validate-trigger":"onChange"},on:{submit:e.onSubmit}},[n("div",{staticClass:"row-section"},[n("p",[e._v("4. "+e._s(e.$t("recharge.RechargeAmount")))]),n("div",{staticClass:"payment-amount-wrapper"},[0===e.fixMoneyArray.length?n("TransparentFieldInput",{attrs:{bind:e.amountField,useStateIcon:!1,placeholder:e.amountPlaceHolder},model:{value:e.amountField.value,callback:function(t){e.$set(e.amountField,"value",t)},expression:"amountField.value"}}):n("div",{staticClass:"fix-amount-box"},e._l(e.fixMoneyArray,(function(t,a){return n("BaseButton",{key:t+a,staticClass:"fix-amount-btn",class:{"btn-active":t+a===e.activeFixMoneyBtnKey},attrs:{type:"button"},on:{click:function(n){return e.onClickFixBtn(t,t+a)}}},[e._v(e._s(t/100))])})),1),8===e.activeMethod.type?[n("div",{staticClass:"usdt-tip"},[e._v(" 1USDT = "),n("span",[e._v(e._s(e.price))]),e._v(" THB ")]),n("div",{staticClass:"usdt-tip"},[e._v(" "+e._s(e.$t("recharge.usdtTip1"))+" "),n("span",[e._v(e._s(e.usdt))]),e._v(" "+e._s(e.$t("recharge.usdtTip2"))+" ")])]:e._e()],2)]),n("div",{staticClass:"row-section tips"},[n("h3",[e._v(e._s(e.$t("recharge.Reminder")))]),n("ul",{style:{listStyle:"decimal",marginLeft:"20px"}},[n("li",[e._v(e._s(e.$t("capitalAcc.FinanceWarning1")))])])]),n("div",{staticClass:"row-section tips"},[n("LinearButton",{attrs:{type:"submit"}},[e._v(e._s(e.$t("recharge.SubmitRecharge")))]),n("LinearButton",{style:{marginTop:"10px"},on:{click:function(t){return e.$router.push({path:"/transactionRecord",query:{acti:0,redirect:e.$router.currentRoute.fullPath}})}}},[e._v(e._s(e.$t("recharge.ViewTopRecord")))])],1)]),n("BaseDialog",{attrs:{confirmButtonText:e.$t("recharge.PaymentCompleted")},on:{confirm:function(t){return e.onDialogConfirm("transferDialog")},cancel:function(t){return e.onCancel("transferDialog")},close:function(t){return e.onDialogClose("transferDialog")}},scopedSlots:e._u([{key:"content",fn:function(){return[n("TransferContent",{attrs:{info:e.transferInfo},on:{"update:info":function(t){e.transferInfo=t}}})]},proxy:!0}]),model:{value:e.isTransferDialogShow,callback:function(t){e.isTransferDialogShow=t},expression:"isTransferDialogShow"}}),n("BaseDialog",{attrs:{cancelButtonText:e.$t("recharge.CancelPayment"),confirmButtonText:e.$t("recharge.ConfirmPayment"),"show-cancel-button":""},on:{confirm:function(t){return e.onDialogConfirm("confirmDialog")},cancel:function(t){return e.onCancel("confirmDialog")},close:function(t){return e.onDialogClose("confirmDialog")}},scopedSlots:e._u([{key:"content",fn:function(){return[n("div",{staticClass:"online-pay-dialog-content"},[n("h3",{staticClass:"title"},[e._v(e._s(e.payInfo.paymentName))]),n("p",{staticClass:"amount"},[e._v(e._s(e.amountField.value))]),n("p",{staticClass:"tips"},[e._v(e._s(e.$t("recharge.PaymentTip",{time:e.payInfo.completeTimeTips})))]),n("div",{staticClass:"payment-wrapper"},[n("BaseCell",{scopedSlots:e._u([{key:"left",fn:function(){return[e._v(e._s(e.$t("recharge.DepositTime")))]},proxy:!0},{key:"middle",fn:function(){return[e._v(e._s((new Date).toLocaleString()))]},proxy:!0}])}),n("BaseCell",{scopedSlots:e._u([{key:"left",fn:function(){return[e._v(e._s(e.$t("recharge.DepositSeris")))]},proxy:!0},{key:"middle",fn:function(){return[n("span",{staticClass:"number"},[e._v(e._s(e.payInfo.tradeNo))])]},proxy:!0}])}),n("BaseCell",{scopedSlots:e._u([{key:"left",fn:function(){return[e._v(e._s(e.$t("recharge.Concessionary")))]},proxy:!0},{key:"middle",fn:function(){return[e._v(e._s(e.activePromotion.name))]},proxy:!0}])}),n("BaseCell",{scopedSlots:e._u([{key:"left",fn:function(){return[e._v(e._s(e.$t("recharge.DepositWay")))]},proxy:!0},{key:"middle",fn:function(){return[e._v(e._s(e.activeMethod.typeName))]},proxy:!0}])})],1)])]},proxy:!0}]),model:{value:e.isOnlinePayConfirmDialogShow,callback:function(t){e.isOnlinePayConfirmDialogShow=t},expression:"isOnlinePayConfirmDialogShow"}})],1)},i=[],o={name:"Recharge",data(){return{showPromotion:!1,activeMethod:{},activeChannel:{},activePromotion:{id:"",name:this.$t("recharge.DiscountNoUse")},activeFixMoneyBtnKey:void 0,paymentMethods:[],promotions:[],payInfo:{},transferInfo:{},isOnlinePayConfirmDialogShow:!1,isTransferDialogShow:!1,price:0,amountField:{name:"amount",value:"",rules:[{required:!0,message:this.$t("recharge.RechargeAmountPlaceholder")},{validator:(e,t)=>/(^\d*$)|(^\d*.\d{1,2}$)/.test(e)?0!==this.activeChannel.depositPerMax||0!==this.activeChannel.depositPerMin?e<this.amountLowerBound?(t.message=this.$t("recharge.RechargeLimitUpperBoundWarning",[this.amountLowerBound]),!1):!(e>this.amountUpperBound)||(t.message=this.$t("recharge.RechargeLimitLowerBoundWarning",[this.amountUpperBound]),!1):e>0:(t.message=this.$t("recharge.RechargeAmountWarning",[this.amountUpperBound]),!1)}]}}},watch:{activeMethod(e){const t=this;8===e.type&&this.$api.wallet.getUsdtPrice({},e=>{t.price=e.data.price})}},computed:{amountUpperBound(){return this.activeChannel.depositPerMax/100||0},amountLowerBound(){return this.activeChannel.depositPerMin/100||0},amountPlaceHolder(){return 0===this.amountLowerBound&&0===this.amountUpperBound?this.$t("recharge.RechargeAmountPlaceholder"):`${this.amountLowerBound} ~ ${this.amountUpperBound}`},bankCardInfo(){return this.activeChannel.id?JSON.parse(this.activeChannel.merchantInfo):{}},fixMoneyArray(){if(this.activeChannel.fixMoney){const e=this.activeChannel.fixMoney.split(",")||[];return e.map(e=>(+e/100).toFixed(2)),e}return[]},usdt(){return this.price?(Number(this.amountField.value)/this.price).toFixed(2):0}},created(){this.getPaymentMethod().then(()=>{this.changeMethod(this.paymentMethods[0]),this.getPromotionList()})},methods:{onSelectPromotion(e){this.showPromotion=!1,this.activePromotion=e},onSubmit(){this.activePromotion.id?this.$api.wallet.qualificationVerify({body:{activityModelId:this.activePromotion.id,memberId:localStorage.getItem("memberId"),type:this.activeChannel.type,online:this.activeChannel.online}},()=>{this.doRecharge()}):this.doRecharge()},onClickFixBtn(e,t){this.amountField.value=e/100,this.activeFixMoneyBtnKey=t},doRecharge(){if(1===this.activeChannel.online){const e={activityId:this.activePromotion.id,money:100*+this.amountField.value,paymentId:this.activeChannel.id};8===this.activeMethod.type&&(e.extend={thirdpartyMoney:parseFloat(parseFloat(100*Number(this.usdt)).toFixed(2))}),this.$api.wallet.UPmoney({body:e},e=>{this.payInfo=e.data,this.payInfo.completeTimeTips=this.activeChannel.completeTimeTips,this.isOnlinePayConfirmDialogShow=!0,this.amountField.value<=1e3?window.gtag("event","充值"):window.gtag("event","充值>1000")})}else this.transferInfo={channelName:this.activeChannel.name,amount:this.amountField.value,paymentMethod:this.activeMethod.typeName,promotionName:this.activePromotion.name,payBankName:this.bankCardInfo.payBankName,payAccount:this.bankCardInfo.payAccount,payRealname:this.bankCardInfo.payRealname,channelType:this.activeChannel.type,completeTimeTips:this.activeChannel.completeTimeTips,transferAccountName:"",transferAccountNumber:""},this.isTransferDialogShow=!0},onDialogClose(e){"transferDialog"===e?this.isTransferDialogShow=!1:"confirmDialog"===e&&(this.isOnlinePayConfirmDialogShow=!1)},onDialogConfirm(e){if("transferDialog"===e){if(!this.transferInfo.transferAccountNumber||!this.transferInfo.transferAccountName)return void this.$cf.toast(this.$t("recharge.RechargeInfoNoCompleteWarning"));const e={activityId:this.activePromotion.id,money:100*this.amountField.value,paymentId:this.activeChannel.id,extend:{account:this.transferInfo.transferAccountNumber,method:"银行卡",realname:this.transferInfo.transferAccountName}};this.$api.wallet.UPmoney({body:e},()=>{this.$cf.showConfirmSuccessDialog({message:this.$t("recharge.PaymentSuccessfulFeedback"),onConfirm:()=>{this.$router.push({path:"/transactionRecord",query:{acti:0,redirect:this.$router.currentRoute.fullPath}}),this.amountField.value<=1e3?window.gtag("event","充值"):window.gtag("event","充值>1000")}})})}else"confirmDialog"===e&&this.createUrl(this.payInfo.tradeNo)},onCancel(e){this.$store.commit("setDialog",{message:`\n        <div class="role-wrap">\n          ${this.$t("recharge.cancelTip")}\n        </div>\n        `,confirmText:this.$t("yes"),cancelText:this.$t("no"),isShowCancelBtn:!0,onConfirm:()=>this.onDialogCancel(e),onCancel:()=>{}})},onDialogCancel(e){"transferDialog"===e?this.onDialogClose(e):"confirmDialog"===e&&(this.$api.wallet.UPcancel({body:{id:this.payInfo.id}},()=>{this.$cf.showSuccessMessageDialog(this.$t("recharge.CancelPaymentFeedback"))}),this.onDialogClose(e))},goBack(){this.$cf.goBack(this.$route)},changeMethod(e){this.activeMethod=e,this.changeChannel(e.list[0])},changeChannel(e){this.activeChannel=e,this.amountField.value=""},getPromotionList(){this.$api.wallet.getyouhuiList({body:{status:1},pageBean:{page:1,pageSize:4}},e=>{if(e.data.push({name:this.$t("recharge.DiscountNoUse"),id:"",lineTypeResponse:[]}),null!==this.activeChannel&&e.data.length>1){const{type:t,online:n}=this.activeChannel;this.promotions=e.data.filter(e=>0===e.lineTypeResponse.length||e.lineTypeResponse.some(e=>e.type===t&&e.online===n))}})},getPaymentMethod(){return new Promise(e=>{this.$api.wallet.getZfLine({body:{}},t=>{var n;this.paymentMethods=(null===(n=t.data)||void 0===n?void 0:n.list)||[],e()})})},createUrl(e){this.$api.wallet.createUrl({body:{tradeNo:e}},e=>{window.location.replace(e.data.payUrl),this.$cf.showConfirmCancelDialog({message:this.$t("recharge.GoPayCheckFeedback"),onConfirm:()=>{this.$cf.showSuccessMessageDialog(this.$t("recharge.PaymentSuccessfulFeedback")),setTimeout(()=>{this.$router.push({path:"/transactionRecord",query:{acti:0,redirect:this.$router.currentRoute.fullPath}})},1500),this.amountField.value<=1e3?window.gtag("event","充值"):window.gtag("event","充值>1000")}})},()=>{})}},components:{LinearButton:()=>n.e("chunk-73bcffce").then(n.bind(null,"ec6b")),TransferContent:()=>n.e("chunk-74d188aa").then(n.bind(null,"4908"))}},r=o,s=(n("2cb3"),n("2877")),c=Object(s["a"])(r,a,i,!1,null,null,null);t["default"]=c.exports},b54e:function(e,t,n){},ba6a:function(e,t,n){var a={"./qrcode-1.png":"091a","./qrcode-2.png":"fb7b","./qrcode-3.png":"69fd","./qrcode-4.png":"eb95","./qrcode-5.png":"7e00","./qrcode-6.png":"42da","./transfer-1.png":"5a2c","./transfer-2.png":"a148","./transfer-3.png":"3625","./transfer-4.png":"4518","./transfer-5.png":"75e0"};function i(e){var t=o(e);return n(t)}function o(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=o,e.exports=i,i.id="ba6a"},eb95:function(e,t,n){e.exports=n.p+"img/qrcode-4.badba066.png"},fb7b:function(e,t,n){e.exports=n.p+"img/qrcode-2.3763a8d4.png"}}]);